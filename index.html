<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>福島・新潟｜絕景慢活六日譚</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&family=Zen+Maru+Gothic:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- Phosphor Icons (Core Library) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'mushiao': '#096148',   /* 虫襖 - 主色 */
                        'yamabuki': '#F8B500',  /* 山吹 - 點綴色 */
                        'neriiro': '#FCFAF2',   /* 練色 - 背景色 */
                        'kesizumi': '#525750',  /* 消炭 - 文字色 */
                        'haiku': '#d6d3d1',     /* 灰 - 輔助線 */
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: #FCFAF2;
            /* 練色 */
            color: #525750;
            /* 消炭 */
            -webkit-tap-highlight-color: transparent;
        }

        h1,
        h2,
        h3,
        .serif {
            font-family: 'Noto Serif TC', serif;
        }

        .bg-pattern {
            background-image: radial-gradient(#d6d3d1 1px, transparent 1px);
            background-size: 32px 32px;
            /* 稍微放大間距，更顯大氣 */
        }

        .btn-nav {
            transition: all 0.2s ease;
        }

        .btn-nav:active {
            transform: scale(0.98);
        }

        .price-tag {
            font-family: 'Zen Maru Gothic', sans-serif;
            font-weight: 700;
            color: #096148;
        }

        /* Fade animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Hide scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Phosphor Icon Styling */
        i.ph-duotone,
        i.ph-bold {
            vertical-align: middle;
            position: relative;
            top: -1px;
        }

        /* Custom opacity for duotone secondary layer - making it richer */
        .ph-duotone {
            --ph-duotone-opacity: 0.3;
        }

        /* Spinner */
        .loader {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #096148;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* --- UI Polish: Custom Input Styles --- */
        /* Hide default datalist arrow to replace with custom icon */
        input::-webkit-calendar-picker-indicator {
            opacity: 0;
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 2.5rem;
            /* Make the click area larger */
            height: 100%;
            cursor: pointer;
            z-index: 10;
        }
    </style>
</head>

<body class="bg-pattern min-h-screen pb-32 flex flex-col items-center relative">

    <!-- Minimal Header with Logo-like feel -->
    <header class="w-full max-w-md pt-10 pb-6 px-6 text-center bg-gradient-to-b from-[#FCFAF2] to-transparent">
        <div class="inline-block border-b-2 border-mushiao pb-3 px-4 relative">
            <span
                class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-[#FCFAF2] px-2 text-[10px] tracking-[0.2em] text-mushiao font-bold whitespace-nowrap">2026
                Japan</span>
            <h1 class="serif text-2xl font-bold text-mushiao tracking-widest leading-relaxed">
                絕景慢活・六日譚
            </h1>
        </div>
    </header>

    <!-- Main Navigation Tabs -->
    <nav class="sticky top-0 z-50 w-full max-w-md bg-[#FCFAF2]/95 backdrop-blur-md border-b border-haiku/30 shadow-sm">
        <div class="flex justify-between px-2">
            <button onclick="switchTab('itinerary')" id="tab-itinerary"
                class="flex-1 py-3 text-center text-mushiao border-b-2 border-mushiao transition-colors relative group">
                <span class="text-sm font-bold flex flex-col items-center gap-1">
                    <i class="ph-duotone ph-path text-xl"></i> 旅路
                </span>
            </button>
            <button onclick="switchTab('info')" id="tab-info"
                class="flex-1 py-3 text-center text-stone-400 border-b-2 border-transparent hover:text-stone-600 transition-colors">
                <span class="text-sm font-medium flex flex-col items-center gap-1">
                    <i class="ph-duotone ph-bed text-xl"></i> 宿行
                </span>
            </button>
            <button onclick="switchTab('budget')" id="tab-budget"
                class="flex-1 py-3 text-center text-stone-400 border-b-2 border-transparent hover:text-stone-600 transition-colors">
                <span class="text-sm font-medium flex flex-col items-center gap-1">
                    <i class="ph-duotone ph-coins text-xl"></i> 預算
                </span>
            </button>
            <button onclick="switchTab('record')" id="tab-record"
                class="flex-1 py-3 text-center text-stone-400 border-b-2 border-transparent hover:text-stone-600 transition-colors">
                <span class="text-sm font-medium flex flex-col items-center gap-1">
                    <i class="ph-duotone ph-pencil-simple-line text-xl"></i> 記帳
                </span>
            </button>
        </div>
    </nav>

    <!-- Main Content Container -->
    <main class="w-full max-w-md p-4 z-10">

        <!-- Tab 1: Itinerary -->
        <div id="content-itinerary" class="space-y-4">
            <!-- Date Subtabs -->
            <div
                class="flex justify-between items-center gap-1 mb-2 px-1 py-2 sticky top-[62px] z-40 bg-[#FCFAF2]/95 backdrop-blur-sm border-b border-haiku/30">
                <button onclick="switchDay(1)" id="subtab-day-1"
                    class="subtab-btn flex-1 py-2 rounded-lg text-[10px] sm:text-xs font-bold border border-mushiao bg-mushiao !text-white shadow-sm transition-all text-center">
                    7/01
                </button>
                <button onclick="switchDay(2)" id="subtab-day-2"
                    class="subtab-btn flex-1 py-2 rounded-lg text-[10px] sm:text-xs font-medium border border-haiku bg-white text-stone-500 hover:border-mushiao hover:text-mushiao transition-all text-center">
                    7/02
                </button>
                <button onclick="switchDay(3)" id="subtab-day-3"
                    class="subtab-btn flex-1 py-2 rounded-lg text-[10px] sm:text-xs font-medium border border-haiku bg-white text-stone-500 hover:border-mushiao hover:text-mushiao transition-all text-center">
                    7/03
                </button>
                <button onclick="switchDay(4)" id="subtab-day-4"
                    class="subtab-btn flex-1 py-2 rounded-lg text-[10px] sm:text-xs font-medium border border-haiku bg-white text-stone-500 hover:border-mushiao hover:text-mushiao transition-all text-center">
                    7/04
                </button>
                <button onclick="switchDay(5)" id="subtab-day-5"
                    class="subtab-btn flex-1 py-2 rounded-lg text-[10px] sm:text-xs font-medium border border-haiku bg-white text-stone-500 hover:border-mushiao hover:text-mushiao transition-all text-center">
                    7/05
                </button>
                <button onclick="switchDay(6)" id="subtab-day-6"
                    class="subtab-btn flex-1 py-2 rounded-lg text-[10px] sm:text-xs font-medium border border-haiku bg-white text-stone-500 hover:border-mushiao hover:text-mushiao transition-all text-center">
                    7/06
                </button>
            </div>

            <!-- Day 1 Content -->
            <div id="day-1" class="day-content animate-fade-in">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-stone-100 relative overflow-hidden">
                    <h2
                        class="serif text-base font-bold text-mushiao mb-2 border-l-4 border-mushiao pl-3 flex justify-between items-center relative z-10">
                        第一日：東京下町
                        <span
                            class="text-[10px] font-sans font-normal text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100">週三</span>
                    </h2>
                    <div
                        class="flex items-center gap-3 text-xs text-stone-500 mb-6 pl-3 bg-stone-50/50 py-1.5 rounded-lg w-max">
                        <span class="flex items-center gap-1 text-stone-600"><i
                                class="ph-duotone ph-cloud-rain text-blue-400 text-base"></i> 24-29°C</span>
                        <span class="text-[10px] text-stone-400 border-l border-stone-300 pl-2">典型的梅雨季末期，悶熱偶雨</span>
                    </div>
                    <div class="space-y-12 border-l-2 border-dashed border-stone-300 ml-3 pl-8 relative z-10">
                        <!-- Spot 1 -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl">
                                <i class="ph-bold ph-airplane-tilt"></i>
                            </span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">台北 TPE <i
                                        class="ph-bold ph-arrow-right text-xs mx-1 text-stone-300"></i> 東京 NRT</h3>
                                <p class="text-xs text-stone-500 mt-1">星宇 JX800 (08:30 - 12:45)</p>
                            </div>

                            <!-- Detailed Transport Card -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <i class="ph-duotone ph-airplane-tilt text-xl text-mushiao"></i>
                                        <div>
                                            <div class="text-xs font-bold text-stone-700">星宇航空 JX800</div>
                                            <div class="text-[10px] text-stone-400">飛行時間約 3h 15m</div>
                                        </div>
                                    </div>
                                </div>
                                <a href="https://www.google.com/search?q=JX800+status" target="_blank"
                                    class="block w-full bg-white border border-mushiao/30 hover:bg-mushiao/5 text-mushiao text-xs font-bold py-2 rounded text-center transition-colors">
                                    <i class="ph-bold ph-magnifying-glass mr-1"></i> 查詢航班動態
                                </a>
                            </div>
                        </div>

                        <!-- Spot 2 -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl">
                                <i class="ph-bold ph-train"></i>
                            </span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">成田機場 <i
                                        class="ph-bold ph-arrow-right text-xs mx-1 text-stone-300"></i> 淺草</h3>
                                <p class="text-xs text-stone-500 mt-1">前往飯店 Check-in</p>
                            </div>

                            <!-- Detailed Transport Card -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <i class="ph-duotone ph-train text-xl text-mushiao"></i>
                                        <div>
                                            <div class="text-xs font-bold text-stone-700">京成 Access 特急</div>
                                            <div class="text-[10px] text-stone-400">直達免轉車</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="text-sm font-bold text-mushiao">¥1,330</span>
                                    </div>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-7 border-l-2 border-stone-200">
                                    往羽田機場方向的列車可直達淺草站 (約60分)
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Narita+Airport&destination=THE+GATE+HOTEL+Kaminarimon+by+HULIC&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-mushiao hover:bg-emerald-800 text-white text-xs font-bold py-2 rounded text-center transition-colors shadow-sm">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 開始導航
                                </a>
                            </div>
                        </div>

                        <!-- Spot 3: Hotel -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl">
                                <i class="ph-bold ph-bed"></i>
                            </span>
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-stone-800 text-sm">The Gate Hotel 雷門</h3>
                                    <p class="text-xs text-stone-500 mt-1">Check-in & 13F大廳賞景</p>
                                </div>
                                <a href="https://www.google.com/maps/search/?api=1&query=THE+GATE+HOTEL+Kaminarimon+by+HULIC"
                                    target="_blank"
                                    class="text-stone-300 hover:text-mushiao text-xl transition-colors"><i
                                        class="ph-duotone ph-map-pin"></i></a>
                            </div>
                        </div>

                        <!-- Spot 4 -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl">
                                <i class="ph-bold ph-storefront"></i>
                            </span>
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-stone-800 text-sm">淺草寺 & 仲見世通</h3>
                                    <p class="text-xs text-stone-500 mt-1">雷門散策、晚餐壽喜燒</p>
                                </div>
                                <a href="https://www.google.com/maps/search/?api=1&query=Sensoji+Temple" target="_blank"
                                    class="text-stone-300 hover:text-mushiao text-xl transition-colors"><i
                                        class="ph-duotone ph-map-pin"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Day 2 Content -->
            <div id="day-2" class="day-content hidden animate-fade-in">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-stone-100 relative overflow-hidden">
                    <h2
                        class="serif text-base font-bold text-mushiao mb-2 border-l-4 border-mushiao pl-3 flex justify-between items-center relative z-10">
                        第二日：無限城之夜
                        <span
                            class="text-[10px] font-sans font-normal text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100">週四</span>
                    </h2>
                    <div
                        class="flex items-center gap-3 text-xs text-stone-500 mb-6 pl-3 bg-stone-50/50 py-1.5 rounded-lg w-max">
                        <span class="flex items-center gap-1 text-stone-600"><i
                                class="ph-duotone ph-cloud-sun text-yamabuki text-base"></i> 22-27°C</span>
                        <span class="text-[10px] text-stone-400 border-l border-stone-300 pl-2">會津山區稍涼，舒適宜人</span>
                    </div>
                    <div class="space-y-12 border-l-2 border-dashed border-stone-300 ml-3 pl-8 relative z-10">
                        <!-- Spot 1: Hotel to Station -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-bed"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">The Gate Hotel 雷門</h3>
                                <p class="text-xs text-stone-500 mt-1">Check-out (大行李寄宅急便)</p>
                            </div>

                            <!-- Transport: Walk -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="flex items-center gap-2 text-stone-600 text-xs font-bold">
                                        <i class="ph-duotone ph-person-simple-walk text-lg"></i> 步行
                                    </div>
                                    <span class="text-xs font-mono text-stone-400">約 3-5 min</span>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-6 border-l-2 border-stone-200">
                                    距離約 250m，過馬路即達車站
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=THE+GATE+HOTEL+Kaminarimon+by+HULIC&destination=Tobu+Asakusa+Station&travelmode=walking"
                                    target="_blank"
                                    class="block w-full bg-white border border-stone-300 hover:bg-stone-100 text-stone-600 text-xs font-bold py-2 rounded text-center transition-colors">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 步行導航
                                </a>
                            </div>
                        </div>

                        <!-- Spot 2: SPACIA X -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-train"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">SPACIA X 豪華移動</h3>
                                <p class="text-xs text-stone-500 mt-1">07:50 淺草發 <i
                                        class="ph-bold ph-arrow-right text-[10px] mx-1"></i> 鬼怒川溫泉轉乘</p>
                            </div>

                            <!-- Transport: Train -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <i class="ph-duotone ph-train text-xl text-mushiao"></i>
                                        <div>
                                            <div class="text-xs font-bold text-stone-700">SPACIA X + 會津特快</div>
                                            <div class="text-[10px] text-stone-400">主要移動 (需預約)</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="text-sm font-bold text-mushiao">¥5,660</span>
                                    </div>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-7 border-l-2 border-stone-200">
                                    <span class="block">1. 東武淺草 ➝ 鬼怒川溫泉 (SPACIA X)</span>
                                    <span class="block text-mushiao font-bold">⚠️ 在鬼怒川溫泉站同月台換車</span>
                                    <span class="block">2. 鬼怒川溫泉 ➝ 塔崖 (AIZU Mount Express)</span>
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Tobu+Asakusa+Station&destination=To-no-Hetsuri+Station&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-mushiao hover:bg-emerald-800 text-white text-xs font-bold py-2 rounded text-center transition-colors shadow-sm">
                                    <i class="ph-bold ph-train mr-1"></i> 路線指引
                                </a>
                            </div>
                        </div>

                        <!-- Spot 3: To-no-Hetsuri -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-mountains"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">塔崖 (塔のへつり)</h3>
                                <p class="text-xs text-stone-500 mt-1">午餐：鹽烤岩魚與蕎麥麵</p>
                            </div>

                            <!-- Transport: Local -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="flex items-center gap-2 text-stone-600 text-xs font-bold">
                                        <i class="ph-duotone ph-bus text-lg"></i> 接駁移動
                                    </div>
                                    <span class="text-xs font-mono text-mushiao">¥1,430</span>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-6 border-l-2 border-stone-200">
                                    電車至湯野上溫泉站，轉乘猿游號巴士
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=To-no-Hetsuri&destination=Ouchijuku&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-white border border-stone-300 hover:bg-stone-100 text-stone-600 text-xs font-bold py-2 rounded text-center transition-colors">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 導航：塔崖 -> 大內宿
                                </a>
                            </div>
                        </div>

                        <!-- Spot 4: Ouchijuku -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-house-line"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">大內宿</h3>
                                <p class="text-xs text-stone-500 mt-1">茅草屋古街、大蔥蕎麥麵</p>
                            </div>
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="flex items-center gap-2 text-stone-600 text-xs font-bold">
                                        <i class="ph-duotone ph-bus text-lg"></i> 巴士+電車+接駁
                                    </div>
                                    <span class="text-xs font-mono text-mushiao">¥530</span>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-6 border-l-2 border-stone-200">
                                    猿游號回車站 -> 電車至蘆之牧溫泉 -> 飯店接駁車
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Ouchijuku&destination=Ashinomaki+Onsen+Ookawaso&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-white border border-stone-300 hover:bg-stone-100 text-stone-600 text-xs font-bold py-2 rounded text-center transition-colors">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 導航至大川莊
                                </a>
                            </div>
                        </div>

                        <!-- Spot 5: Hotel -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-moon-stars"></i></span>
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-stone-800 text-sm">蘆之牧溫泉 大川莊</h3>
                                    <p class="text-xs text-stone-500 mt-1">三味線演奏、梯田溫泉</p>
                                </div><a
                                    href="https://www.google.com/maps/search/?api=1&query=Ashinomaki+Onsen+Ookawaso"
                                    target="_blank"
                                    class="text-stone-300 hover:text-mushiao text-xl transition-colors"><i
                                        class="ph-duotone ph-map-pin"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Day 3 Content -->
            <div id="day-3" class="day-content hidden animate-fade-in">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-stone-100 relative overflow-hidden">
                    <h2
                        class="serif text-base font-bold text-mushiao mb-2 border-l-4 border-mushiao pl-3 flex justify-between items-center relative z-10">
                        第三日：螺旋與秘境
                        <span
                            class="text-[10px] font-sans font-normal text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100">週五</span>
                    </h2>
                    <div
                        class="flex items-center gap-3 text-xs text-stone-500 mb-6 pl-3 bg-stone-50/50 py-1.5 rounded-lg w-max">
                        <span class="flex items-center gap-1 text-stone-600"><i
                                class="ph-duotone ph-cloud-fog text-stone-400 text-base"></i> 20-25°C</span>
                        <span class="text-[10px] text-stone-400 border-l border-stone-300 pl-2">奧會津濕度高，清晨易有夢幻川霧</span>
                    </div>
                    <div class="space-y-12 border-l-2 border-dashed border-stone-300 ml-3 pl-8 relative z-10">
                        <!-- Spot 1 -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-bed"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">大川莊</h3>
                                <p class="text-xs text-stone-500 mt-1">Check-out (悠閒早餐)</p>
                            </div>
                            <!-- Transport: Taxi -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="flex items-center gap-2 text-stone-600 text-xs font-bold">
                                        <i class="ph-duotone ph-taxi text-lg text-mushiao"></i> 建議搭計程車
                                    </div>
                                    <span class="text-xs font-mono text-stone-500">~¥5,000 (分攤)</span>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-6 border-l-2 border-stone-200">
                                    直接前往榮螺堂最省時 (約25分)，避免轉車搬行李
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Ashinomaki+Onsen+Ookawaso&destination=Aizu+Sazaedo&travelmode=driving"
                                    target="_blank"
                                    class="block w-full bg-white border border-stone-300 hover:bg-stone-100 text-stone-600 text-xs font-bold py-2 rounded text-center transition-colors">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 導航：大川莊 -> 榮螺堂
                                </a>
                            </div>
                        </div>

                        <!-- Spot 2 -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-spiral"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">會津榮螺堂</h3>
                                <p class="text-xs text-stone-500 mt-1">雙螺旋建築奇觀</p>
                            </div>

                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="flex items-center gap-2 text-stone-600 text-xs font-bold">
                                        <i class="ph-duotone ph-taxi text-lg"></i> 計程車/巴士
                                    </div>
                                    <span class="text-xs font-mono text-stone-500">~¥1,200</span>
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Aizu+Sazaedo&destination=Aizu-Wakamatsu+Station&travelmode=driving"
                                    target="_blank"
                                    class="block w-full bg-white border border-stone-300 hover:bg-stone-100 text-stone-600 text-xs font-bold py-2 rounded text-center transition-colors">
                                    <i class="ph-duotone ph-fork-knife mr-1"></i> 往 會津若松站 (午餐)
                                </a>
                            </div>
                        </div>

                        <!-- Spot 3: Tadami Line -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-train"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">JR 只見線 (前半)</h3>
                                <p class="text-xs text-stone-500 mt-1">13:05 會津若松發車 (建議座位：左側)</p>
                            </div>

                            <!-- Transport: Green Card -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <i class="ph-duotone ph-train text-xl text-mushiao"></i>
                                        <div>
                                            <div class="text-xs font-bold text-stone-700">只見線絕景鐵道</div>
                                            <div class="text-[10px] text-stone-400">前往早戶站</div>
                                        </div>
                                    </div>
                                    <span class="text-sm font-bold text-mushiao">¥860</span>
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Aizu-Wakamatsu+Station&destination=Hayato+Station&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-mushiao hover:bg-emerald-800 text-white text-xs font-bold py-2 rounded text-center transition-colors shadow-sm">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 開始導航
                                </a>
                            </div>
                        </div>

                        <!-- Spot 4 -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-house-simple"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">早戶溫泉 鶴之湯</h3>
                                <p class="text-xs text-stone-500 mt-1">只見川畔秘境溫泉</p>
                            </div>
                            <div class="mt-2 bg-stone-50/50 rounded p-2 border border-stone-100">
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Hayato+Station&destination=早戸温泉つるの湯+福島&travelmode=walking"
                                    target="_blank"
                                    class="flex items-center justify-center w-full bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 text-xs font-bold py-1.5 rounded transition-colors btn-nav shadow-sm"><i
                                        class="ph-duotone ph-navigation-arrow mr-1.5 text-lg"></i> 導航：早戶站 <i
                                        class="ph-bold ph-arrow-right mx-1 text-[10px]"></i> 鶴之湯</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Day 4 Content -->
            <div id="day-4" class="day-content hidden animate-fade-in">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-stone-100 relative overflow-hidden">
                    <h2
                        class="serif text-base font-bold text-mushiao mb-2 border-l-4 border-mushiao pl-3 flex justify-between items-center relative z-10">
                        第四日：夢幻川霧
                        <span
                            class="text-[10px] font-sans font-normal text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100">週六</span>
                    </h2>
                    <div
                        class="flex items-center gap-3 text-xs text-stone-500 mb-6 pl-3 bg-stone-50/50 py-1.5 rounded-lg w-max">
                        <span class="flex items-center gap-1 text-stone-600"><i
                                class="ph-duotone ph-cloud-fog text-stone-400 text-base"></i> 19-26°C</span>
                        <span class="text-[10px] text-stone-400 border-l border-stone-300 pl-2">清晨涼爽有霧，午後轉陰多雲</span>
                    </div>
                    <div class="space-y-12 border-l-2 border-dashed border-stone-300 ml-3 pl-8 relative z-10">
                        <!-- Spot 1 -->
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-bed"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">鶴之湯</h3>
                                <p class="text-xs text-stone-500 mt-1">Check-out (早起看霧)</p>
                            </div>
                            <div class="mt-2 bg-stone-50/50 rounded p-2 border border-stone-100"><a
                                    href="https://www.google.com/maps/dir/?api=1&origin=早戸温泉つるの湯+福島&destination=Mugenkyo+no+Watashi&travelmode=walking"
                                    target="_blank"
                                    class="flex items-center justify-center w-full bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 text-xs font-bold py-1.5 rounded transition-colors btn-nav shadow-sm"><i
                                        class="ph-duotone ph-navigation-arrow mr-1.5 text-lg"></i> 導航：飯店 <i
                                        class="ph-bold ph-arrow-right mx-1 text-[10px]"></i> 霧幻峽</a></div>
                        </div>

                        <!-- Spot 2 -->
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-boat"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">霧幻峽渡船</h3>
                                <p class="text-xs text-stone-500 mt-1">07:00 晨霧泛舟體驗</p>
                            </div>

                            <!-- Transport: Taxi -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="flex items-center gap-2 text-stone-600 text-xs font-bold">
                                        <i class="ph-duotone ph-taxi text-lg text-mushiao"></i> 計程車 (需預約)
                                    </div>
                                    <span class="text-xs font-mono text-mushiao">~¥2,000</span>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-6 border-l-2 border-stone-200">
                                    渡船結束後，請船家協助叫車至展望台登山口
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Mugenkyo+no+Watashi&destination=First+Tadami+River+Bridge+Viewpoint&travelmode=driving"
                                    target="_blank"
                                    class="block w-full bg-white border border-stone-300 hover:bg-stone-100 text-stone-600 text-xs font-bold py-2 rounded text-center transition-colors">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 導航至展望台
                                </a>
                            </div>
                        </div>

                        <!-- Spot 3 -->
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-camera"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">第一只見川橋樑 展望台</h3>
                                <p class="text-xs text-stone-500 mt-1">絕景攝影點</p>
                            </div>
                            <div class="mt-2 bg-stone-50/50 rounded p-2 border border-stone-100"><a
                                    href="https://www.google.com/maps/dir/?api=1&origin=Mishima+Juku&destination=Aizu-Miyashita+Station&travelmode=walking"
                                    target="_blank"
                                    class="flex items-center justify-center w-full bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 text-xs font-bold py-1.5 rounded transition-colors btn-nav shadow-sm"><i
                                        class="ph-duotone ph-navigation-arrow mr-1.5 text-lg"></i> 導航：展望台 <i
                                        class="ph-bold ph-arrow-right mx-1 text-[10px]"></i> 會津宮下站</a></div>
                        </div>

                        <!-- Spot 4: Tadami Line Part 2 -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-train"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">JR 只見線 (後半)</h3>
                                <p class="text-xs text-stone-500 mt-1">14:52 會津宮下發車 (建議座位：左側 賞田子倉湖)</p>
                            </div>

                            <!-- Transport: Green Card -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <i class="ph-duotone ph-train text-xl text-mushiao"></i>
                                        <div>
                                            <div class="text-xs font-bold text-stone-700">只見線絕景鐵道</div>
                                            <div class="text-[10px] text-stone-400">前往小出站</div>
                                        </div>
                                    </div>
                                    <span class="text-sm font-bold text-mushiao">¥1,690</span>
                                </div>
                                <div class="text-[10px] text-stone-500 mb-2 pl-7 border-l-2 border-stone-200">
                                    只見線至小出轉乘上越線 -> 越後湯澤
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Aizu-Miyashita+Station&destination=Hatago+Isen&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-mushiao hover:bg-emerald-800 text-white text-xs font-bold py-2 rounded text-center transition-colors shadow-sm">
                                    <i class="ph-bold ph-navigation-arrow mr-1"></i> 開始導航
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Day 5 Content -->
            <div id="day-5" class="day-content hidden animate-fade-in">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-stone-100 relative overflow-hidden">
                    <h2
                        class="serif text-base font-bold text-mushiao mb-2 border-l-4 border-mushiao pl-3 flex justify-between items-center relative z-10">
                        第五日：光之隧道
                        <span
                            class="text-[10px] font-sans font-normal text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100">週日</span>
                    </h2>
                    <div
                        class="flex items-center gap-3 text-xs text-stone-500 mb-6 pl-3 bg-stone-50/50 py-1.5 rounded-lg w-max">
                        <span class="flex items-center gap-1 text-stone-600"><i
                                class="ph-duotone ph-sun text-yamabuki text-base"></i> 22-29°C</span>
                        <span class="text-[10px] text-stone-400 border-l border-stone-300 pl-2">新潟夏日清爽，適合登高望遠</span>
                    </div>
                    <div class="space-y-12 border-l-2 border-dashed border-stone-300 ml-3 pl-8 relative z-10">
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-bed"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">HATAGO 井仙</h3>
                                <p class="text-xs text-stone-500 mt-1">Check-out (寄放行李)</p>
                            </div>
                            <div class="mt-2 bg-stone-50/50 rounded p-2 border border-stone-100"><a
                                    href="https://www.google.com/maps/dir/?api=1&origin=Echigo-Yuzawa+Station&destination=Kiyotsu+Gorge+Tunnel&travelmode=transit"
                                    target="_blank"
                                    class="flex items-center justify-center w-full bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 text-xs font-bold py-1.5 rounded transition-colors btn-nav shadow-sm"><i
                                        class="ph-duotone ph-navigation-arrow mr-1.5 text-lg"></i> 導航：越後湯澤站 <i
                                        class="ph-bold ph-arrow-right mx-1 text-[10px]"></i> 清津峽</a></div>
                        </div>
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-camera"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">清津峽 (光之隧道)</h3>
                                <p class="text-xs text-stone-500 mt-1">天空之鏡</p>
                            </div>
                            <div class="mt-2 bg-stone-50/50 rounded p-2 border border-stone-100"><a
                                    href="https://www.google.com/maps/dir/?api=1&origin=Kiyotsu+Gorge+Tunnel&destination=Yuzawa+Kogen+Ropeway&travelmode=transit"
                                    target="_blank"
                                    class="flex items-center justify-center w-full bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 text-xs font-bold py-1.5 rounded transition-colors btn-nav shadow-sm"><i
                                        class="ph-duotone ph-navigation-arrow mr-1.5 text-lg"></i> 導航：清津峽 <i
                                        class="ph-bold ph-arrow-right mx-1 text-[10px]"></i> 纜車站</a></div>
                        </div>

                        <!-- Spot 3: Shinkansen -->
                        <div class="relative group">
                            <span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-cable-car"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">湯澤高原空中纜車</h3>
                                <p class="text-xs text-stone-500 mt-1">雲之上露台</p>
                            </div>

                            <!-- Transport: Green Card -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <i class="ph-duotone ph-train text-xl text-mushiao"></i>
                                        <div>
                                            <div class="text-xs font-bold text-stone-700">上越新幹線</div>
                                            <div class="text-[10px] text-stone-400">返回東京 (指定席)</div>
                                        </div>
                                    </div>
                                    <span class="text-sm font-bold text-mushiao">¥6,790</span>
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Echigo-Yuzawa+Station&destination=karaksa+hotel+Tokyo+Station&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-mushiao hover:bg-emerald-800 text-white text-xs font-bold py-2 rounded text-center transition-colors shadow-sm">
                                    <i class="ph-bold ph-train mr-1"></i> 開始導航
                                </a>
                            </div>
                        </div>
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-house-line"></i></span>
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-stone-800 text-sm">Karaksa Hotel Tokyo Station</h3>
                                    <p class="text-xs text-stone-500 mt-1">東京車站八重洲口</p>
                                </div><a
                                    href="https://www.google.com/maps/search/?api=1&query=karaksa+hotel+Tokyo+Station"
                                    target="_blank"
                                    class="text-stone-300 hover:text-mushiao text-xl transition-colors"><i
                                        class="ph-duotone ph-map-pin"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="day-6" class="day-content hidden animate-fade-in">
                <div class="bg-white p-5 rounded-xl shadow-sm border border-stone-100 relative overflow-hidden">
                    <h2
                        class="serif text-base font-bold text-mushiao mb-2 border-l-4 border-mushiao pl-3 flex justify-between items-center relative z-10">
                        第六日：歸途
                        <span
                            class="text-[10px] font-sans font-normal text-stone-400 bg-stone-50 px-2 py-1 rounded-full border border-stone-100">週一</span>
                    </h2>
                    <div
                        class="flex items-center gap-3 text-xs text-stone-500 mb-6 pl-3 bg-stone-50/50 py-1.5 rounded-lg w-max">
                        <span class="flex items-center gap-1 text-stone-600"><i
                                class="ph-duotone ph-sun text-yamabuki text-base"></i> 26-31°C</span>
                        <span class="text-[10px] text-stone-400 border-l border-stone-300 pl-2">東京盛夏，注意防曬補水</span>
                    </div>
                    <div class="space-y-12 border-l-2 border-dashed border-stone-300 ml-3 pl-8 relative z-10">
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-bed"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">Karaksa Hotel</h3>
                                <p class="text-xs text-stone-500 mt-1">Check-out (寄放行李)</p>
                            </div>
                            <div class="mt-2 bg-stone-50/50 rounded p-2 border border-stone-100"><a
                                    href="https://www.google.com/maps/dir/?api=1&origin=karaksa+hotel+Tokyo+Station&destination=Ginza+Station&travelmode=walking"
                                    target="_blank"
                                    class="flex items-center justify-center w-full bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 text-xs font-bold py-1.5 rounded transition-colors btn-nav shadow-sm"><i
                                        class="ph-duotone ph-navigation-arrow mr-1.5 text-lg"></i> 導航：飯店 <i
                                        class="ph-bold ph-arrow-right mx-1 text-[10px]"></i> 銀座</a></div>
                        </div>
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-shopping-bag"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">銀座 / 皇居</h3>
                                <p class="text-xs text-stone-500 mt-1">上午自由活動</p>
                            </div>

                            <!-- Transport: NEX -->
                            <div class="mt-3 bg-stone-50 rounded-lg p-3 border border-stone-200">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <i class="ph-duotone ph-train text-xl text-mushiao"></i>
                                        <div>
                                            <div class="text-xs font-bold text-stone-700">成田特快 (NEX)</div>
                                            <div class="text-[10px] text-stone-400">直達機場</div>
                                        </div>
                                    </div>
                                    <span class="text-sm font-bold text-mushiao">¥3,070</span>
                                </div>
                                <a href="https://www.google.com/maps/dir/?api=1&origin=Tokyo+Station&destination=Narita+Airport&travelmode=transit"
                                    target="_blank"
                                    class="block w-full bg-mushiao hover:bg-emerald-800 text-white text-xs font-bold py-2 rounded text-center transition-colors shadow-sm">
                                    <i class="ph-duotone ph-airplane-tilt mr-1.5 text-lg"></i> 導航：東京站 <i
                                        class="ph-bold ph-arrow-right mx-1 text-[10px]"></i> 成田機場
                                </a>
                            </div>

                        </div>
                        <div class="relative group"><span
                                class="absolute -left-[53px] top-0 w-10 h-10 rounded-full bg-white border-2 border-mushiao shadow-sm z-10 flex items-center justify-center text-mushiao text-xl"><i
                                    class="ph-bold ph-airplane-tilt"></i></span>
                            <div>
                                <h3 class="font-bold text-stone-800 text-sm">東京 NRT <i
                                        class="ph-bold ph-arrow-right text-xs mx-1 text-stone-300"></i> 台北 TPE</h3>
                                <p class="text-xs text-stone-500 mt-1">回程航班建議 (二選一)</p>
                            </div>
                            <div class="space-y-3 mt-3">
                                <div
                                    class="bg-stone-50/50 rounded-lg p-3 border border-stone-200 relative overflow-hidden">
                                    <div
                                        class="absolute top-0 right-0 bg-mushiao text-white text-[9px] px-2 py-0.5 rounded-bl font-bold">
                                        推薦</div>
                                    <h4 class="text-xs font-bold text-stone-800 mb-1">星宇 JX803 (悠閒回家)</h4>
                                    <div class="flex justify-between text-[10px] text-stone-500"><span><i
                                                class="ph-duotone ph-clock mr-1"></i>16:30 NRT <i
                                                class="ph-bold ph-arrow-right mx-1 text-[8px]"></i> 19:10 TPE</span>
                                    </div>
                                    <p class="text-[9px] text-stone-400 mt-1">優點：回家不累，隔天上班精神好</p>
                                </div>
                                <div class="bg-stone-50/50 rounded-lg p-3 border border-stone-200">
                                    <h4 class="text-xs font-bold text-stone-800 mb-1">長榮 BR195 (玩好玩滿)</h4>
                                    <div class="flex justify-between text-[10px] text-stone-500"><span><i
                                                class="ph-duotone ph-clock mr-1"></i>20:40 NRT <i
                                                class="ph-bold ph-arrow-right mx-1 text-[8px]"></i> 23:25 TPE</span>
                                    </div>
                                    <p class="text-[9px] text-stone-400 mt-1">優點：多玩半天，適合體力好的人</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center text-stone-400 text-xs py-8 opacity-60">
                <p class="font-serif italic">Have a nice trip.</p>
            </div>
        </div>

        <!-- Tab 2: Info (Same as previous) -->
        <div id="content-info" class="hidden space-y-6 animate-fade-in z-10 relative">
            <h3 class="serif text-lg font-bold text-stone-700 border-b border-stone-300 pb-2 mb-4">宿泊案內</h3>
            <div class="space-y-4">
                <!-- Hotels list (same as previous) -->
                <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-mushiao">
                    <h4 class="font-bold text-mushiao">The Gate Hotel 雷門</h4>
                    <p class="text-xs text-stone-500 mb-3">東京淺草 | Day 1</p>
                    <div class="flex gap-2">
                        <a href="https://www.google.com/maps/search/?api=1&query=THE+GATE+HOTEL+Kaminarimon+by+HULIC"
                            target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-map-pin"></i> 地圖</a>
                        <a href="https://www.gate-hotel.jp/kaminarimon/" target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-globe"></i> 官網</a>
                    </div>
                </div>
                <!-- Other hotels... -->
                <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-mushiao">
                    <h4 class="font-bold text-mushiao">蘆之牧溫泉 大川莊</h4>
                    <p class="text-xs text-stone-500 mb-3">福島會津 | Day 2</p>
                    <p class="text-xs text-stone-600 mb-3 bg-yellow-50 p-2 rounded"><i
                            class="ph-duotone ph-warning text-yamabuki mr-1"></i> 需提前預約接駁車</p>
                    <div class="flex gap-2">
                        <a href="https://www.google.com/maps/search/?api=1&query=Ashinomaki+Onsen+Ookawaso"
                            target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-map-pin"></i> 地圖</a>
                        <a href="http://www.ookawaso.co.jp/" target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-globe"></i> 官網</a>
                    </div>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-mushiao">
                    <h4 class="font-bold text-mushiao">早戶溫泉 鶴之湯</h4>
                    <p class="text-xs text-stone-500 mb-3">福島奧會津 | Day 3</p>
                    <div class="flex gap-2">
                        <a href="https://www.google.com/maps/search/?api=1&query=Hayato+Onsen+Tsurunoyu" target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-map-pin"></i> 地圖</a>
                        <a href="https://okuaizu-tsurunoyu.jp/" target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-globe"></i> 官網</a>
                    </div>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-mushiao">
                    <h4 class="font-bold text-mushiao">HATAGO 井仙</h4>
                    <p class="text-xs text-stone-500 mb-3">新潟越後湯澤 | Day 4</p>
                    <div class="flex gap-2">
                        <a href="https://www.google.com/maps/search/?api=1&query=Hatago+Isen" target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-map-pin"></i> 地圖</a>
                        <a href="https://hatago-isen.jp/" target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-globe"></i> 官網</a>
                    </div>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-sm border-l-4 border-mushiao">
                    <h4 class="font-bold text-mushiao">Karaksa Hotel Tokyo Station</h4>
                    <p class="text-xs text-stone-500 mb-3">東京車站 | Day 5</p>
                    <div class="flex gap-2">
                        <a href="https://www.google.com/maps/search/?api=1&query=karaksa+hotel+Tokyo+Station"
                            target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-map-pin"></i> 地圖</a>
                        <a href="https://karaksahotels.com/tokyostation/" target="_blank"
                            class="flex-1 bg-emerald-50 text-mushiao text-xs py-2 rounded text-center font-bold"><i
                                class="ph-duotone ph-globe"></i> 官網</a>
                    </div>
                </div>
            </div>
            <h3 class="serif text-lg font-bold text-stone-700 border-b border-stone-300 pb-2 mb-4 pt-4">交通攻略</h3>
            <div class="bg-stone-50 p-5 rounded-xl text-sm text-stone-700 space-y-4 shadow-inner">
                <!-- Transport tips (same as previous) -->
                <div class="flex items-start gap-3">
                    <div
                        class="mt-1 w-6 h-6 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0 text-mushiao">
                        <i class="ph-bold ph-train text-xs"></i></div>
                    <div>
                        <strong class="block text-mushiao">SPACIA X 預約</strong>
                        <p class="text-xs mt-1 leading-relaxed">請務必於 <span class="text-red-500 font-bold">6月1日
                                08:00</span> (乘車一個月前) 上網搶票。推薦 Cockpit Lounge。</p>
                        <p class="text-xs text-stone-400 mt-1">票價：運費+特急費約 ¥3,340 /人</p>
                    </div>
                </div>
                <div class="flex items-start gap-3">
                    <div
                        class="mt-1 w-6 h-6 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0 text-mushiao">
                        <i class="ph-bold ph-suitcase-rolling text-xs"></i></div>
                    <div>
                        <strong class="block text-mushiao">行李宅急便 (重要)</strong>
                        <p class="text-xs mt-1 leading-relaxed">Day 2 早上在淺草將大行李寄往「Day 4 住宿
                            (HATAGO井仙)」。只需攜帶輕便背包前往大內宿與只見線。</p>
                        <p class="text-xs text-stone-400 mt-1">預估運費：約 ¥2,000 /件</p>
                    </div>
                </div>
                <div class="flex items-start gap-3">
                    <div
                        class="mt-1 w-6 h-6 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0 text-mushiao">
                        <i class="ph-bold ph-boat text-xs"></i></div>
                    <div>
                        <strong class="block text-mushiao">霧幻峽渡船</strong>
                        <p class="text-xs mt-1 leading-relaxed">全預約制。請事先至官網預約 Day 4 早上 07:00 的船班，並確認接送地點。</p>
                        <p class="text-xs text-stone-400 mt-1">費用：約 ¥6,000 /船 (多人分攤)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ... (Tab 3: Budget - Same as previous) ... -->
        <div id="content-budget" class="hidden space-y-6 animate-fade-in z-10 relative">
            <h3 class="serif text-lg font-bold text-stone-700 text-center mb-2">費用預估 (每人)</h3>

            <!-- Simple Currency Calculator -->
            <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-4 mb-4">
                <h4 class="text-xs font-bold text-stone-500 mb-2 flex items-center gap-1">
                    <i class="ph-duotone ph-calculator text-mushiao"></i> 匯率試算
                </h4>
                <div class="flex items-center gap-2">
                    <div class="relative flex-1">
                        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-xs text-stone-400">¥</span>
                        <input type="number" id="calc-jpy" placeholder="日幣"
                            class="w-full text-sm border-stone-200 rounded-lg pl-6 py-1.5 focus:ring-mushiao focus:border-mushiao"
                            oninput="calculateTWD()">
                    </div>
                    <i class="ph-bold ph-arrow-right text-stone-300 text-xs"></i>
                    <div class="relative flex-1">
                        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-xs text-stone-400">$</span>
                        <input type="text" id="calc-twd" placeholder="台幣"
                            class="w-full text-sm border-stone-200 rounded-lg pl-6 py-1.5 bg-stone-50 text-stone-600 font-bold"
                            readonly>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-sm overflow-hidden border border-stone-200">
                <table class="w-full text-sm text-left text-stone-600">
                    <thead class="text-xs text-stone-500 uppercase bg-stone-50 border-b border-stone-100">
                        <tr>
                            <th scope="col" class="px-6 py-4 font-bold tracking-wider">項目</th>
                            <th scope="col" class="px-6 py-4 text-right font-bold tracking-wider">預估</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="bg-white border-b border-stone-100 hover:bg-stone-50 transition-colors">
                            <td class="px-6 py-4 font-medium text-stone-800">
                                <div class="flex items-center gap-2"><i
                                        class="ph-duotone ph-airplane-tilt text-mushiao text-xl"></i> 機票</div>
                                <div class="text-[10px] text-stone-400 mt-1 pl-7">星宇/長榮 早去晚回</div>
                            </td>
                            <td class="px-6 py-4 text-right font-mono">22,000</td>
                        </tr>
                        <tr class="bg-white border-b border-stone-100 hover:bg-stone-50 transition-colors">
                            <td class="px-6 py-4 font-medium text-stone-800">
                                <div class="flex items-center gap-2"><i
                                        class="ph-duotone ph-bed text-mushiao text-xl"></i> 住宿</div>
                                <div class="text-[10px] text-stone-400 mt-1 pl-7">5宿 (含3宿一泊二食)</div>
                            </td>
                            <td class="px-6 py-4 text-right font-mono">28,000</td>
                        </tr>
                        <tr class="bg-white border-b border-stone-100 hover:bg-stone-50 transition-colors">
                            <td class="px-6 py-4 font-medium text-stone-800">
                                <div class="flex items-center gap-2"><i
                                        class="ph-duotone ph-train text-mushiao text-xl"></i> 交通</div>
                                <div class="text-[10px] text-stone-400 mt-1 pl-7">特急/新幹線/計程車</div>
                            </td>
                            <td class="px-6 py-4 text-right font-mono">8,000</td>
                        </tr>
                        <tr class="bg-white hover:bg-stone-50 transition-colors">
                            <td class="px-6 py-4 font-medium text-stone-800">
                                <div class="flex items-center gap-2"><i
                                        class="ph-duotone ph-fork-knife text-mushiao text-xl"></i> 餐飲/雜支</div>
                                <div class="text-[10px] text-stone-400 mt-1 pl-7">午餐/船票/門票</div>
                            </td>
                            <td class="px-6 py-4 text-right font-mono">10,000</td>
                        </tr>
                        <tr class="bg-emerald-50 text-mushiao border-t-2 border-emerald-100">
                            <td class="px-6 py-4 font-bold">總計</td>
                            <td class="px-6 py-4 text-right font-bold font-mono text-lg">68,000</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div
                class="bg-yellow-50 border border-yellow-100 rounded-xl p-4 text-xs text-yellow-800 mt-4 flex gap-3 shadow-sm">
                <i class="ph-fill ph-lightbulb text-yamabuki text-base mt-0.5"></i>
                <div>
                    <strong class="block mb-1">省錢小貼士</strong>
                    此預算為「寬裕版」估算。若機票選擇廉航、住宿避開週五週六，或晚餐選擇較簡單，總預算可控制在 55,000 元左右。
                </div>
            </div>
        </div>

        <!-- Tab 4: Record Expenses (Updated) -->
        <div id="content-record" class="hidden space-y-6 animate-fade-in z-10 relative">
            <h3 class="serif text-lg font-bold text-stone-700 text-center mb-2">旅途記帳</h3>

            <div id="exchange-rate-display"
                class="text-center text-xs text-stone-400 mb-4 font-mono tracking-wider bg-white py-1.5 rounded-lg border border-stone-100 shadow-sm mx-auto w-max px-4">
                <i class="ph-duotone ph-arrows-left-right text-emerald-500 mr-1"></i> 匯率載入中...
            </div>

            <!-- Google Apps Script Config -->
            <div class="bg-stone-100 p-3 rounded-lg border border-stone-200 mb-4">
                <label class="block text-[10px] font-bold text-stone-500 mb-1">Google Apps Script URL (雲端同步)</label>
                <input type="text" id="gas-url" placeholder="請貼上您的 GAS 網址 (https://script.google.com/...)"
                    class="w-full text-xs p-2 rounded border border-stone-300 focus:border-mushiao focus:ring-1 focus:ring-mushiao"
                    onchange="saveGasUrl()">
                <p class="text-[9px] text-stone-400 mt-1">*貼上網址後自動儲存，與朋友共用此網址即可同步。</p>
            </div>

            <!-- Input Form (Improved UI) -->
            <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-4">
                <div class="grid grid-cols-1 gap-3">
                    <!-- Category with Custom Indicator -->
                    <div class="relative">
                        <input list="category-options" id="expense-category" placeholder="類別 (可選或自訂)"
                            class="w-full text-base border-stone-200 rounded-lg focus:ring-mushiao focus:border-mushiao bg-stone-50 py-3 px-3 pr-10"
                            autocomplete="off">
                        <div
                            class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-stone-400">
                            <i class="ph-bold ph-caret-down"></i>
                        </div>
                        <datalist id="category-options">
                            <!-- JS will populate default options -->
                        </datalist>
                    </div>
                    <input type="text" id="expense-item" placeholder="項目 (例: 蕎麥麵)"
                        class="w-full text-base border-stone-200 rounded-lg focus:ring-mushiao focus:border-mushiao py-3 px-3">

                    <!-- Currency, Amount & Button Row (Aligned) -->
                    <div class="flex gap-2 items-stretch">
                        <!-- Currency Selector -->
                        <div class="relative w-24">
                            <select id="expense-currency"
                                class="w-full h-full text-sm font-bold border-stone-200 rounded-lg focus:ring-mushiao focus:border-mushiao bg-stone-50 pl-3 pr-8 appearance-none">
                                <option value="JPY" selected>JPY</option>
                                <option value="TWD">TWD</option>
                            </select>
                            <div
                                class="absolute right-2 top-1/2 -translate-y-1/2 text-stone-400 text-xs pointer-events-none">
                                <i class="ph-bold ph-caret-down"></i>
                            </div>
                        </div>
                        <!-- Amount Input -->
                        <input type="number" id="expense-amount" placeholder="金額"
                            class="flex-1 text-base border-stone-200 rounded-lg focus:ring-mushiao focus:border-mushiao py-3 px-3">
                        <!-- Add Button -->
                        <button onclick="addExpense()" id="btn-add"
                            class="bg-mushiao text-white px-4 rounded-lg text-sm font-bold shadow-sm active:scale-95 transition-transform flex items-center justify-center gap-1 w-20">
                            <i class="ph-bold ph-plus text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- List & Total -->
            <div class="bg-white rounded-xl shadow-sm border border-stone-200 overflow-hidden">
                <div class="bg-stone-50 px-4 py-3 border-b border-stone-200 flex justify-between items-center">
                    <span class="text-xs font-bold text-stone-600 uppercase">雲端紀錄</span>
                    <button onclick="fetchExpenses()"
                        class="text-[10px] text-mushiao hover:text-emerald-700 flex items-center gap-1"><i
                            class="ph-bold ph-arrows-clockwise"></i> 重新整理</button>
                </div>
                <div id="expense-list"
                    class="divide-y divide-stone-100 max-h-80 overflow-y-auto min-h-[100px] relative">
                    <div class="p-4 text-center text-xs text-stone-400">請設定 GAS URL 並載入資料</div>
                </div>
                <div class="bg-emerald-50 px-4 py-3 border-t border-emerald-100 flex justify-between items-center">
                    <span class="text-sm font-bold text-mushiao">總計 (JPY)</span>
                    <span id="expense-total" class="text-lg font-bold text-mushiao font-mono">¥0</span>
                </div>
            </div>
            <p class="text-center text-[10px] text-stone-400 mt-2 flex justify-center items-center gap-1">
                <i class="ph-duotone ph-cloud-check"></i> 資料儲存於 Google Sheets
            </p>
        </div>

    </main>

    <script>
        // --- CONFIGURATION ZONE ---
        const HARDCODED_GAS_URL = "";

        // --- Navigation Logic ---
        function switchTab(tabId) {
            const tabs = ['itinerary', 'info', 'budget', 'record'];
            tabs.forEach(t => {
                document.getElementById(`content-${t}`).classList.add('hidden');
                const tabBtn = document.getElementById(`tab-${t}`);
                tabBtn.classList.remove('text-mushiao', 'border-mushiao', 'font-bold');
                tabBtn.classList.add('text-stone-400', 'border-transparent');
            });
            document.getElementById(`content-${tabId}`).classList.remove('hidden');
            const activeTab = document.getElementById(`tab-${tabId}`);
            activeTab.classList.remove('text-stone-400', 'border-transparent');
            activeTab.classList.add('text-mushiao', 'border-mushiao', 'font-bold');
        }

        function switchDay(dayNum) {
            // Restore hidden day divs for this logic to work in full file
            const days = document.querySelectorAll('.day-content');
            days.forEach(day => day.classList.add('hidden'));

            const target = document.getElementById(`day-${dayNum}`);
            if (target) target.classList.remove('hidden');

            const subtabs = document.querySelectorAll('.subtab-btn');
            subtabs.forEach(btn => {
                btn.classList.remove('border-mushiao', 'bg-mushiao', '!text-white', 'shadow-md', 'font-bold');
                btn.classList.add('border-haiku', 'bg-white', 'text-stone-500', 'font-medium');
            });
            const activeSubtab = document.getElementById(`subtab-day-${dayNum}`);
            if (activeSubtab) {
                activeSubtab.classList.remove('border-haiku', 'bg-white', 'text-stone-500', 'font-medium');
                activeSubtab.classList.add('border-mushiao', 'bg-mushiao', '!text-white', 'shadow-md', 'font-bold');
            }
        }

        // Exchange Rate
        let currentExchangeRate = 0.23;
        async function fetchExchangeRate() {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/JPY');
                const data = await response.json();
                currentExchangeRate = data.rates.TWD;
                const date = new Date(data.date).toLocaleDateString();
                document.getElementById('exchange-rate-display').innerHTML = `<i class="ph-duotone ph-currency-yen text-emerald-500 mr-1"></i>1 JPY ≈ <span class="font-bold text-mushiao">${currentExchangeRate.toFixed(4)}</span> TWD <span class="text-[9px] ml-2 text-stone-300">(${date} 更新)</span>`;
            } catch (error) { console.error(error); }
        }
        function calculateTWD() {
            const jpy = parseFloat(document.getElementById('calc-jpy').value);
            if (!isNaN(jpy)) {
                const twd = (jpy * currentExchangeRate).toFixed(0);
                document.getElementById('calc-twd').value = parseInt(twd).toLocaleString();
            } else { document.getElementById('calc-twd').value = ''; }
        }

        // --- Google Sheets Sync Logic ---
        const DEFAULT_CATEGORIES = ['食', '宿', '交通', '購物', '娛樂', '門票'];

        document.addEventListener('DOMContentLoaded', () => {
            const dayContents = document.querySelectorAll('.day-content');
            if (dayContents.length > 0) {
                for (let i = 1; i < dayContents.length; i++) dayContents[i].classList.add('hidden');
            }

            initCategories();
            fetchExchangeRate();

            let savedUrl = HARDCODED_GAS_URL;
            if (!savedUrl) {
                savedUrl = localStorage.getItem('gasAppUrl');
            } else {
                const input = document.getElementById('gas-url');
                if (input) {
                    input.value = savedUrl;
                    input.readOnly = true;
                    input.classList.add('bg-gray-100', 'text-gray-500');
                }
            }

            if (savedUrl) {
                const input = document.getElementById('gas-url');
                if (input) input.value = savedUrl;
                fetchExpenses();
            }
        });

        function saveGasUrl() {
            const url = document.getElementById('gas-url').value.trim();
            localStorage.setItem('gasAppUrl', url);
            fetchExpenses();
        }

        function initCategories() {
            const datalist = document.getElementById('category-options');
            datalist.innerHTML = '';
            DEFAULT_CATEGORIES.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                datalist.appendChild(option);
            });
        }

        function getCategoryIcon(cat) {
            if (cat.includes('食')) return '<i class="ph-duotone ph-bowl-food text-mushiao text-xl"></i>';
            if (cat.includes('宿')) return '<i class="ph-duotone ph-bed text-mushiao text-xl"></i>';
            if (cat.includes('交通') || cat.includes('車') || cat.includes('機')) return '<i class="ph-duotone ph-train text-yamabuki text-xl"></i>';
            if (cat.includes('購') || cat.includes('買')) return '<i class="ph-duotone ph-shopping-bag text-mushiao text-xl"></i>';
            if (cat.includes('樂') || cat.includes('票')) return '<i class="ph-duotone ph-ticket text-mushiao text-xl"></i>';
            return '<i class="ph-duotone ph-tag text-stone-400 text-xl"></i>';
        }

        async function fetchExpenses() {
            const url = HARDCODED_GAS_URL || localStorage.getItem('gasAppUrl');
            const listEl = document.getElementById('expense-list');
            const totalEl = document.getElementById('expense-total');

            if (!url) {
                listEl.innerHTML = '<div class="p-4 text-center text-xs text-stone-400">請輸入 Google Apps Script 網址以啟用同步</div>';
                return;
            }

            listEl.innerHTML = '<div class="p-8 text-center"><div class="loader"></div><p class="text-xs text-stone-400 mt-2">載入中...</p></div>';

            try {
                if (!url.startsWith('http')) {
                    throw new Error("網址格式錯誤，請檢查是否有貼上正確的 Web App URL");
                }

                if (!url.includes('/exec')) {
                    throw new Error("網址格式警告：請確認您複製的是部署後的 Web App URL (通常以 /exec 結尾)");
                }

                const response = await fetch(url);

                const contentType = response.headers.get("content-type");
                if (contentType && contentType.indexOf("application/json") === -1) {
                    throw new Error("格式錯誤：伺服器回傳了 HTML (可能是錯誤頁面，請檢查 GAS 權限是否設為 '所有人')");
                }

                const data = await response.json();

                if (data.error) {
                    throw new Error("GAS 錯誤: " + data.error);
                }

                listEl.innerHTML = '';
                let total = 0;

                if (!Array.isArray(data) || data.length === 0) {
                    listEl.innerHTML = '<div class="p-4 text-center text-xs text-stone-400">目前沒有雲端紀錄</div>';
                } else {
                    data.reverse().forEach((exp, index) => {
                        const originalIndex = (data.length - 1) - index;

                        const amount = parseInt(exp.amount) || 0;
                        total += amount;

                        let dateStr = exp.date;
                        try {
                            const d = new Date(exp.date);
                            if (!isNaN(d.getTime())) dateStr = `${d.getMonth() + 1}/${d.getDate()}`;
                        } catch (e) { }

                        const div = document.createElement('div');
                        div.className = 'px-4 py-3 flex justify-between items-center hover:bg-stone-50 animate-fade-in group';
                        div.innerHTML = `
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-stone-100 flex items-center justify-center flex-shrink-0">
                                    ${getCategoryIcon(exp.category)}
                                </div>
                                <div>
                                    <div class="text-sm font-bold text-stone-700">${exp.item}</div>
                                    <div class="text-[10px] text-stone-400">
                                        <span class="bg-stone-100 px-1.5 py-0.5 rounded text-stone-500 mr-1">${exp.category}</span>
                                        ${dateStr}
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="text-sm font-mono font-bold text-stone-600">¥${amount.toLocaleString()}</span>
                                <button onclick="deleteCloudExpense(${originalIndex})" class="text-stone-300 hover:text-red-500 transition-colors p-2 rounded-full hover:bg-red-50">
                                    <i class="ph-bold ph-trash text-lg"></i>
                                </button>
                            </div>
                        `;
                        listEl.appendChild(div);
                    });
                }
                totalEl.innerText = '¥' + total.toLocaleString();

            } catch (error) {
                console.error(error);
                let msg = "載入失敗";
                let testLink = `<a href="${url}" target="_blank" class="underline text-mushiao mt-1 block">點此在新視窗測試連結</a>`;

                if (error.message.includes("HTML")) msg = "載入失敗：權限不足或程式碼未更新 (HTML)";
                else if (error.message.includes("GAS")) msg = error.message;
                else msg = error.message;

                listEl.innerHTML = `<div class="p-4 text-center text-xs text-red-400">${msg}<br>請檢查 GAS 部署版本與權限${testLink}</div>`;
            }
        }

        async function addExpense() {
            const url = HARDCODED_GAS_URL || localStorage.getItem('gasAppUrl');
            if (!url) { alert('請先設定 Google Apps Script 網址'); return; }

            const catInput = document.getElementById('expense-category');
            const itemInput = document.getElementById('expense-item');
            const amountInput = document.getElementById('expense-amount');
            const currencyInput = document.getElementById('expense-currency');
            const btn = document.getElementById('btn-add');

            const category = catInput.value.trim() || '未分類';
            let item = itemInput.value.trim();
            let amount = parseInt(amountInput.value);
            const currency = currencyInput.value;

            if (!item || isNaN(amount)) { alert('請輸入項目與金額'); return; }

            if (currency === 'TWD') {
                const originalAmount = amount;
                const rate = currentExchangeRate || 0.23;
                amount = Math.round(originalAmount / rate);
                item = `${item} (NT$${originalAmount})`;
            }

            const originalBtnText = btn.innerHTML;
            btn.innerHTML = '<div class="loader w-3 h-3 border-white border-t-transparent"></div>';
            btn.disabled = true;

            const payload = {
                action: 'add',
                date: new Date().toISOString(),
                category,
                item,
                amount
            };

            try {
                await fetch(url, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'text/plain' }, // Avoid preflight
                    body: JSON.stringify(payload)
                });

                itemInput.value = '';
                amountInput.value = '';

                setTimeout(() => {
                    fetchExpenses();
                    btn.innerHTML = originalBtnText;
                    btn.disabled = false;
                }, 1500);

            } catch (error) {
                alert('新增失敗，請檢查網路');
                console.error(error);
                btn.innerHTML = originalBtnText;
                btn.disabled = false;
            }
        }

        async function deleteCloudExpense(index) {
            if (!confirm('確定要刪除這筆紀錄嗎？')) return;

            const url = HARDCODED_GAS_URL || localStorage.getItem('gasAppUrl');
            if (!url) return;

            const payload = {
                action: 'delete',
                index: index
            };

            try {
                await fetch(url, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'text/plain' },
                    body: JSON.stringify(payload)
                });

                setTimeout(() => {
                    fetchExpenses();
                }, 1500);
            } catch (error) {
                alert('刪除失敗');
                console.error(error);
            }
        }
    </script>
</body>

</html>